<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright (C) 1988-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "Free Software" and "Free Software Needs
Free Documentation", with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.

(a) The FSF's Back-Cover Text is: "You are free to copy and modify
this GNU Manual.  Buying copies from GNU Press supports the FSF in
developing GNU and promoting software freedom."

Copyright (C) 2024, Intel Corporation.
Intel's modifications are provided pursuant to the GNU Free
Documentation license. -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>x86 (Debugging with GDB)</title>

<meta name="description" content="x86 (Debugging with GDB)">
<meta name="keywords" content="x86 (Debugging with GDB)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Concept-Index.html#Concept-Index" rel="index" title="Concept Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Architectures.html#Architectures" rel="up" title="Architectures">
<link href="Alpha.html#Alpha" rel="next" title="Alpha">
<link href="AArch64.html#AArch64" rel="prev" title="AArch64">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="x86"></a>
<div class="header">
<p>
Next: <a href="Alpha.html#Alpha" accesskey="n" rel="next">Alpha</a>, Previous: <a href="AArch64.html#AArch64" accesskey="p" rel="prev">AArch64</a>, Up: <a href="Architectures.html#Architectures" accesskey="u" rel="up">Architectures</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="x86-1"></a>
<h4 class="subsection">21.4.2 x86</h4>

<dl compact="compact">
<dt><code>set struct-convention <var>mode</var></code></dt>
<dd><a name="index-set-struct_002dconvention"></a>
<a name="index-struct-return-convention"></a>
<a name="index-struct_002funion-returned-in-registers"></a>
<p>Set the convention used by the inferior to return <code>struct</code>s and
<code>union</code>s from functions to <var>mode</var>.  Possible values of
<var>mode</var> are <code>&quot;pcc&quot;</code>, <code>&quot;reg&quot;</code>, and <code>&quot;default&quot;</code> (the
default).  <code>&quot;default&quot;</code> or <code>&quot;pcc&quot;</code> means that <code>struct</code>s
are returned on the stack, while <code>&quot;reg&quot;</code> means that a
<code>struct</code> or a <code>union</code> whose size is 1, 2, 4, or 8 bytes will
be returned in a register.
</p>
</dd>
<dt><code>show struct-convention</code></dt>
<dd><a name="index-show-struct_002dconvention"></a>
<p>Show the current setting of the convention to return <code>struct</code>s
from functions.
</p></dd>
</dl>

<a name="x87-registers"></a>
<h4 class="subsubsection">21.4.2.1 x87 registers</h4>

<p><small>GDB</small> provides access to the x87 state through the following registers:
</p>
<ul>
<li> <code>$st0</code> to <code>st7</code>: <code>ST(0)</code> to <code>ST(7)</code> floating-point
registers
</li><li> <code>$fctrl</code>: control word register (<code>FCW</code>)
</li><li> <code>$fstat</code>: status word register (<code>FSW</code>)
</li><li> <code>$ftag</code>: tag word (<code>FTW</code>)
</li><li> <code>$fiseg</code>: last instruction pointer segment
</li><li> <code>$fioff</code>: last instruction pointer
</li><li> <code>$foseg</code>: last data pointer segment
</li><li> <code>$fooff</code>: last data pointer
</li><li> <code>$fop</code>: last opcode

</li></ul>

<a name="Intel-Control_002dflow-Enforcement-Technology-_0028CET_0029_002e"></a>
<h4 class="subsubsection">21.4.2.2 Intel <em>Control-flow Enforcement Technology</em> (CET).</h4>
<a name="index-Intel-Control_002dflow-Enforcement-Technology-_0028CET_0029_002e"></a>

<p>Control-flow Enforcement Technology (CET) provides two capabilities to defend
against &ldquo;Return-oriented Programming&rdquo; and &ldquo;call/jmp-oriented
programming&rdquo; style control-flow attacks:
</p>
<ul>
<li> Shadow Stack:
A shadow stack is a second stack for a program.  It holds the return
addresses pushed by the call instruction.  The <code>RET</code> instruction pops the
return addresses from both call and shadow stack.  If the return addresses from
the two stacks do not match, the processor signals a control protection
exception.
</li><li> Indirect Branch Tracking (IBT):
When IBT is enabled, the CPU implements a state machine that tracks indirect
<code>JMP</code> and <code>CALL</code> instructions.  The state machine can be either IDLE
or WAIT_FOR_ENDBRANCH.  In WAIT_FOR_ENDBRANCH state the next instruction in
the program stream must be an <code>ENDBR</code> instruction, otherwise the
processor signals a control protection exception.
</li></ul>

<p>Impact on GDB commands:
</p><ul>
<li> Call/Print:
Inferior calls in <small>GDB</small> reset the current PC to the beginning of the
function that is called.  No call instruction is executed, but the <code>RET</code>
instruction actually is.  To avoid a control protection exception due to the
missing return address on the shadow stack, <small>GDB</small> pushes the new return
address to the shadow stack and updates the shadow stack pointer.
</li><li> Step:
With displaced stepping, <small>GDB</small> may run an out of line copy of a call
instruction.  In this case, the wrong return address is pushed on the shadow
stack.  <small>GDB</small> corrects this value to avoid a control protection
exception.  For more details on displaced stepping, see <a href="Maintenance-Commands.html#displaced_002dstepping">displaced-stepping</a>.
</li></ul>

<a name="Intel-Advanced-Matrix-Extensions-_0028AMX_0029_002e"></a>
<h4 class="subsubsection">21.4.2.3 Intel <em>Advanced Matrix Extensions</em> (AMX).</h4>
<a name="index-Advanced-Matrix-Extensions-_0028AMX_0029_002e"></a>

<p>Advanced Matrix Extensions (AMX) adds one 64 byte &lsquo;<samp>TILECFG</samp>&rsquo; register and
eight 1024 byte tile registers &lsquo;<samp>TMM0</samp>&rsquo;, &lsquo;<samp>TMM1</samp>&rsquo;, ..., &lsquo;<samp>TMM7</samp>&rsquo;.
The tile registers each represent a matrix, whose dimensions are configured via
&lsquo;<samp>TILECFG</samp>&rsquo;.  Future platforms might also partition the register area of
8 * 1024 bytes between a different number of tiles.
</p>
<p>To present such big registers in a user friendly way, <small>GDB</small> represents
the &lsquo;<samp>TILECFG</samp>&rsquo; and tile registers as pseudo registers.
The &lsquo;<samp>TILECFG</samp>&rsquo; is shown as a <code>struct</code>, omitting reserved bits.
The full register can still be viewed using &lsquo;<samp>TILECFG_RAW</samp>&rsquo;.  The tile
registers are sized dynamically according to the configuration in
&lsquo;<samp>TILECFG</samp>&rsquo;.  For example:
</p>
<div class="smallexample">
<pre class="smallexample">	(gdb) print/x $tilecfg_raw
	$1 = 0x203020000000000000000000000000000000000000000000000000000001000
	10000c00000000000000000000000000000001
	(gdb) print $tilecfg
	$2 = {palette = 0x1, start_row = 0x0, tile0.colsb = 0xc,
	tile1.colsb = 0x10, tile2.colsb = 0x10, tile3.colsb = 0x0,
	tile4.colsb = 0x0, tile5.colsb = 0x0, tile6.colsb = 0x0,
	tile7.colsb = 0x0, tile0.rows = 0x2, tile1.rows = 0x3, tile2.rows = 0x2,
	tile3.rows = 0x0, tile4.rows = 0x0, tile5.rows = 0x0, tile6.rows = 0x0,
	tile7.rows = 0x0}
	(gdb) p $tmm0.m_int8
	$3 = {{0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2},	{1, 1, 1, 1, 2, 2, 2,
	2, 3, 3, 3, 3}}
</pre></div>

<p>The raw register data for tiles can be seen in the register
&lsquo;<samp>TILEDATA</samp>&rsquo;, which represents the whole 8 * 1024 bytes available for tiles.
Setting any pseudo register will result in changes in the corresponding raw
register (e.g. &lsquo;<samp>TILECFG_RAW</samp>&rsquo; and &lsquo;<samp>TILEDATA</samp>&rsquo;).
</p>

<hr>
<div class="header">
<p>
Next: <a href="Alpha.html#Alpha" accesskey="n" rel="next">Alpha</a>, Previous: <a href="AArch64.html#AArch64" accesskey="p" rel="prev">AArch64</a>, Up: <a href="Architectures.html#Architectures" accesskey="u" rel="up">Architectures</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Concept-Index.html#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
